

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WapVault - Digital Vault</title>

   <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-03NYM2DSY1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-03NYM2DSY1');
</script>

    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #282c34;
            color: white;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        .container {
            background: #1c1e22;
            padding: 2em;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            max-width: 800px;
            width: 100%;
        }
        .container h2 {
            margin-bottom: 1em;
            color: #f39c12;
        }
        .container button, .container input, .container textarea {
            margin: 0.5em 0;
            padding: 10px;
            border: 1px solid #f39c12;
            border-radius: 4px;
            width: 100%;
            background-color: #333;
            color: white;
        }
        .container button:hover {
            background-color: #f39c12;
            color: #000;
            cursor: pointer;
        }
        .asset-list {
            list-style: none;
            padding: 0;
        }
        .asset-item {
            padding: 1em;
            border-bottom: 1px solid #f39c12;
        }
        .file-input {
            display: none;
        }
        .vault-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .asset-controls {
            display: flex;
            justify-content: space-between;
        }
        .asset-controls button {
            width: 48%;
        }
        #assetViewer {
            display: none;
            padding: 2em;
            border-radius: 8px;
            background: #1c1e22;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            max-width: 800px;
            width: 100%;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
        }
        #assetViewer img, #assetViewer iframe {
            width: 100%;
            height: auto;
        }
        #aiOutput {
            margin-top: 1em;
            background-color: #282c34;
            padding: 1em;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        .message {
            display: none;
            color: blue;
            cursor: pointer;
        }
    </style>
</head>
<body>
 <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CosmicWallet</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
        }

        .full-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #282c34;
            z-index: 1000; /* Ensure it's above other content */
        }

        .auth-section {
            max-width: 400px;
            width: 100%;
            margin: auto;
            text-align: center;
        }

        .hidden {
            display: none;
        }

        .container {
            padding: 23px;
        }
    </style>
</head>
<body>
    <!-- Authentication Page -->
    <div id="authPage" class="full-page bg-gray-100 flex items-center justify-center min-h-screen">
        <div id="setupSection" class="auth-section bg-white p-8 rounded-lg shadow-lg">
            <h2 class="text-2xl font-bold mb-4">Set Up Authentication</h2>
            <input type="password" id="setupPin" placeholder="Set your PIN" class="w-full p-2 border border-gray-300 rounded mb-4" />
            <button onclick="setupPIN()" class="bg-blue-500 text-white p-2 rounded w-full mb-4">Set Up PIN</button>
             </div>
        <div id="loginSection" class="auth-section bg-white p-8 rounded-lg shadow-lg hidden">
            <h2 class="text-2xl font-bold mb-4">Login</h2>
            <input type="password" id="loginPin" placeholder="Enter PIN" class="w-full p-2 border border-gray-300 rounded mb-4" />
            <button onclick="login()" class="bg-blue-500 text-white p-2 rounded w-full mb-4">Login</button>
               </div>
        
        <button onclick="clearBiometricData()" class="bg-red-500 text-white p-2 rounded w-full mt-2">Clear Biometric Data</button>
    </div>

    
        

    <!-- Main Application -->
    <div id="appContainer" class="container hidden">
        <!-- Your existing CosmicWallet content goes here -->
        <div id="balance-section" class="flex justify-between items-center my-4">
            <!-- existing content -->
        </div>
        <div class="container mx-auto p-4 bg-white rounded-lg shadow-lg">
            <!-- existing content -->
        </div>
    </div>

    <!-- JavaScript for authentication and inactivity logout -->
    <script>
    
document.addEventListener('DOMContentLoaded', () => {
    const authPage = document.getElementById('authPage');
    const setupSection = document.getElementById('setupSection');
    const loginSection = document.getElementById('loginSection');
    const mainApp = document.getElementById('mainApp');

    const setupPIN = () => {
        const pin = document.getElementById('setupPin').value;
        if (pin) {
            const hashedPin = CryptoJS.SHA256(pin).toString();
            localStorage.setItem('cosmicWalletPin', hashedPin);
            alert('PIN set successfully!');
            setupSection.classList.add('hidden');
            loginSection.classList.remove('hidden');
        } else {
            alert('Please enter a PIN.');
        }
    };

    const login = () => {
        const pin = document.getElementById('loginPin').value;
        const storedPinHash = localStorage.getItem('cosmicWalletPin');
        if (CryptoJS.SHA256(pin).toString() === storedPinHash) {
            alert('Login successful!');
            authPage.classList.add('hidden');
            mainApp.classList.remove('hidden');
            startRewardingUsers(); // Start rewards on successful login
            fetchBalances(); // Fetch balances on successful login
        } else {
            alert('Incorrect PIN.');
        }
    };

    const setupFingerprint = () => {
        if (!window.PublicKeyCredential) {
            alert('WebAuthn is not supported on this browser.');
            return;
        }

        const publicKey = {
            challenge: new Uint8Array(32),
            rp: {
                name: 'CosmicWallet',
                id: window.location.hostname
            },
            user: {
                id: new Uint8Array(16),
                name: 'user@example.com',
                displayName: 'User'
            },
            pubKeyCredParams: [{ type: 'public-key', alg: -7 }],
            authenticatorSelection: {
                authenticatorAttachment: 'platform',
                requireResidentKey: false,
                userVerification: 'preferred'
            },
            timeout: 60000,
            attestation: 'none'
        };

        navigator.credentials.create({ publicKey })
            .then((credential) => {
                const rawId = btoa(String.fromCharCode(...new Uint8Array(credential.rawId)));
                localStorage.setItem('cosmicWalletCredentialId', credential.id);
                localStorage.setItem('cosmicWalletRawId', rawId);

                alert('Fingerprint setup successful!');
                setupSection.classList.add('hidden');
                loginSection.classList.remove('hidden');
            })
            .catch((error) => {
                alert('Fingerprint setup failed. Please try again.');
                console.error('Error during fingerprint setup:', error);
            });
    };

    const authenticateWithFingerprint = () => {
        const storedCredentialId = localStorage.getItem('cosmicWalletCredentialId');
        const rawId = localStorage.getItem('cosmicWalletRawId');

        if (!storedCredentialId || !rawId) {
            alert('No fingerprint credentials found. Please set up your fingerprint first.');
            return;
        }

        const publicKey = {
            challenge: new Uint8Array(32),
            allowCredentials: [{
                type: 'public-key',
                id: Uint8Array.from(atob(rawId), c => c.charCodeAt(0))
            }],
            timeout: 60000,
            userVerification: 'preferred'
        };

        navigator.credentials.get({ publicKey })
            .then((assertion) => {
                if (assertion.id === storedCredentialId) {
                    alert('Fingerprint login successful!');
                    authPage.classList.add('hidden');
                    mainApp.classList.remove('hidden');
                    startRewardingUsers(); // Start rewards on successful login
                    fetchBalances(); // Fetch balances on successful login
                } else {
                    alert('Fingerprint login failed.');
                }
            })
            .catch((error) => {
                alert('Fingerprint login failed. Please try again.');
                console.error('Error during fingerprint authentication:', error);
            });
    };

    const clearBiometricData = () => {
        localStorage.removeItem('cosmicWalletCredentialId');
        localStorage.removeItem('cosmicWalletRawId');
        alert('Biometric data cleared. You can now set up your fingerprint again.');
        setupSection.classList.remove('hidden');
        loginSection.classList.add('hidden');
    };

    const fetchBalances = async () => {
        const ethBalance = await getEthBalance();
        const cosmicBalance = await getCosmicBalance();
        const bnbBalance = await getBnbBalance();

        document.getElementById('eth-balance').textContent = `${ethBalance} ETH`;
        document.getElementById('cosmic-balance').textContent = `${cosmicBalance} COSMIC`;
        document.getElementById('bnb-balance').textContent = `${bnbBalance} BNB`;
    };

    const getEthBalance = async () => {
        // Add your logic to fetch Ethereum balance
        return 0; // Placeholder
    };

    const getCosmicBalance = async () => {
        // Add your logic to fetch CosmicCoin balance
        return 0; // Placeholder
    };

    const getBnbBalance = async () => {
        // Add your logic to fetch BNB balance
        return 0; // Placeholder
    };

    window.setupPIN = setupPIN;
    window.login = login;
    window.setupFingerprint = setupFingerprint;
    window.authenticateWithFingerprint = authenticateWithFingerprint;
    window.clearBiometricData = clearBiometricData;

    // Check if PIN or Fingerprint is already set
    if (localStorage.getItem('cosmicWalletPin') || localStorage.getItem('cosmicWalletCredentialId')) {
        setupSection.classList.add('hidden');
        loginSection.classList.remove('hidden');
    } else {
        setupSection.classList.remove('hidden');
        loginSection.classList.add('hidden');
    }
});

        
    </script>
</body>
</html>
                    
            
    <div class="container" id="vaultContainer">
        <div class="vault-header">
            <h2>WapVault - Digital Vault</h2>
        </div>
        <div id="mainContainer" style="display: none;">
            <h3>Add Digital Asset</h3>
            <input type="text" id="assetTitle" placeholder="Title" required>
            <textarea id="assetDescription" placeholder="Description" required></textarea>
            <input type="file" id="assetFile" class="file-input" multiple>
            <button type="button" onclick="triggerFileInput()">Import from Device</button>
            <button type="button" onclick="addAsset()">Add Asset</button>
            <h3>Digital Assets</h3>
            <ul id="assetList" class="asset-list"></ul>
        </div>
    </div>

    <div id="assetViewer">
        <h3>Asset Viewer</h3>
        <div id="assetContent"></div>
        <button type="button" onclick="closeViewer()">Close</button>
        <div id="aiOutput"></div>
    </div>

    <script src="script.js"></script>
    <script>
       

        // Function to add a digital asset
        function addAsset() {
            const title = document.getElementById('assetTitle').value;
            const description = document.getElementById('assetDescription').value;
            const files = document.getElementById('assetFile').files;

            if (!title || !description) {
                alert("Both title and description are required.");
                return;
            }

            const asset = {
                title: title,
                description: description,
                files: [],
                timestamp: new Date()
            };

            for (let i = 0; i < files.length; i++) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    asset.files.push({
                        name: files[i].name,
                        data: e.target.result
                    });

                    if (asset.files.length === files.length) {
                        saveAsset(asset);
                    }
                };
                reader.readAsDataURL(files[i]);
            }

            if (files.length === 0) {
                saveAsset(asset);
            }
        }

        function saveAsset(asset) {
            let assets = JSON.parse(localStorage.getItem('assets')) || [];
            assets.push(asset);
            localStorage.setItem('assets', JSON.stringify(assets));

            alert("Asset added successfully.");
            loadAssets();
            document.getElementById('assetTitle').value = '';
            document.getElementById('assetDescription').value = '';
            document.getElementById('assetFile').value = '';
        }

        // Function to load and display digital assets
        function loadAssets() {
            const assets = JSON.parse(localStorage.getItem('assets')) || [];
            const assetList = document.getElementById('assetList');
            assetList.innerHTML = "";
            assets.forEach((asset, index) => {
                const listItem = document.createElement('li');
                listItem.className = "asset-item";
                listItem.innerHTML = `
                    <strong>${asset.title}</strong><br>${asset.description}<br><em>${new Date(asset.timestamp).toLocaleString()}</em>
                    <div class="asset-controls">
                        <button type="button" onclick="viewAsset(${index})">View</button>
                        <button type="button" onclick="deleteAsset(${index})">Delete</button>
                    </div>`;
                assetList.appendChild(listItem);
            });
        }

        function viewAsset(index) {
            const assets = JSON.parse(localStorage.getItem('assets')) || [];
            const asset = assets[index];
            const assetContent = document.getElementById('assetContent');
            assetContent.innerHTML = `<h4>${asset.title}</h4><p>${asset.description}</p>`;

            asset.files.forEach(file => {
                if (file.name.endsWith('.jpg') || file.name.endsWith('.png') || file.name.endsWith('.gif')) {
                    assetContent.innerHTML += `<img src="${file.data}" alt="${file.name}">`;
                } else if (file.name.endsWith('.pdf')) {
                    assetContent.innerHTML += `<iframe src="${file.data}" frameborder="0"></iframe>`;
                } else {
                    assetContent.innerHTML += `<a href="${file.data}" download="${file.name}">${file.name}</a>`;
                }
            });

            document.getElementById('assetViewer').style.display = 'block';
        }

        function closeViewer() {
            document.getElementById('assetViewer').style.display = 'none';
        }

        function deleteAsset(index) {
            let assets = JSON.parse(localStorage.getItem('assets')) || [];
            assets.splice(index, 1);
            localStorage.setItem('assets', JSON.stringify(assets));
            loadAssets();
        }

        function triggerFileInput() {
            document.getElementById('assetFile').click();
        }

        
    </script>
</body>
</html>
